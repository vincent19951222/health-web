<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIå¥åº·æŠ¥å‘Šè¯¦æƒ… - ä¼˜å”æ™ºèƒ½AI+</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Markdownæ¸²æŸ“åº“ -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- ä»£ç é«˜äº®åº“ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <style>
        /* ç³–å°¿ç—…æ§ç³–ç®¡ç†å¹³å° - ç»Ÿä¸€æ ·å¼æ–‡ä»¶ */

        /* æ ¹æ®UI_design.mdçš„è®¾è®¡è§„åˆ™å®šä¹‰é¢œè‰² */
        /* ä¸»è‰²è°ƒ */
        .primary-color { color: #3b82f6; }
        .primary-dark { color: #2563eb; }
        .secondary-color { color: #f97316; }
        .secondary-dark { color: #ea580c; }

        /* åŒ»ç–—ä¸»é¢˜è‰²å½© */
        .medical-blue { color: #3b82f6; }
        .medical-green { color: #22c55e; }
        .medical-red { color: #ef4444; }
        .medical-orange { color: #f59e0b; }
        .medical-purple { color: #8b5cf6; }

        /* ä¸­æ€§è‰² */
        .gray-50 { color: #f9fafb; }
        .gray-100 { color: #f3f4f6; }
        .gray-200 { color: #e5e7eb; }
        .gray-300 { color: #d1d5db; }
        .gray-400 { color: #9ca3af; }
        .gray-500 { color: #6b7280; }
        .gray-600 { color: #4b5563; }
        .gray-700 { color: #374151; }
        .gray-800 { color: #1f2937; }
        .gray-900 { color: #111827; }

        /* éšè—æ‰€æœ‰æ»šåŠ¨æ¡ */
        * {
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        *::-webkit-scrollbar {
            display: none;
        }

        /* é€šç”¨æ ·å¼ */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #1f2937;
            background-color: #f9fafb;
        }

        .step-container {
            min-height: 100vh;
            position: relative;
        }

        .step-content {
            padding: 16px;
            padding-bottom: 100px; /* ä¸ºåº•éƒ¨æŒ‰é’®ç•™å‡ºç©ºé—´ */
        }

        /* å¤´éƒ¨æ ·å¼ */
        .header {
            background: white;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            position: relative;
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
        }

        .back-btn {
            color: #6b7280;
            transition: color 0.2s ease;
            cursor: pointer;
        }

        .back-btn:hover {
            color: #374151;
        }

        .back-btn i {
            font-size: 18px;
        }

        .header-title {
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }

        .header-spacer {
            width: 24px;
            height: 24px;
        }

        /* å¤šåª’ä½“æŠ¥å‘Šå¡ç‰‡æ ·å¼ */
        .medical-report-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .report-content {
            line-height: 1.6;
        }

        .report-content h1, .report-content h2, .report-content h3 {
            color: #374151;
            margin-bottom: 12px;
            margin-top: 0px;
        }

        .report-content h1 { font-size: 24px; font-weight: 700; }
        .report-content h2 { font-size: 20px; font-weight: 600; }
        .report-content h3 { font-size: 18px; font-weight: 600; }

        .report-content p {
            margin-bottom: 12px;
            color: #374151;
        }

        .report-content ul, .report-content ol {
            margin-bottom: 12px;
            padding-left: 20px;
        }

        .report-content li {
            margin-bottom: 4px;
            color: #374151;
        }

        .report-content blockquote {
            border-left: 4px solid #3b82f6;
            padding-left: 16px;
            margin: 16px 0;
            background: #f9fafb;
            padding: 12px 16px;
            border-radius: 8px;
        }

        .report-content code {
            background: #f3f4f6;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .report-content pre {
            background: #f3f4f6;
            padding: 16px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 12px 0;
        }

        .media-container {
            margin: 16px 0;
            border-radius: 12px;
            overflow: hidden;
        }

        .media-image {
            width: 100%;
            height: auto;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .media-video {
            width: 100%;
            height: 200px;
            border-radius: 12px;
        }

        .media-audio {
            width: 100%;
            margin: 8px 0;
        }

        .media-caption {
            text-align: center;
            font-size: 14px;
            color: #6b7280;
            margin-top: 8px;
            font-style: italic;
        }

        .report-section {
            margin-bottom: 24px;
        }

        .report-highlight {
            background: linear-gradient(135deg, #3b82f6, #22c55e);
            color: white;
            padding: 16px;
            border-radius: 12px;
            margin: 16px 0;
        }

        .report-warning {
            background: #fef3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 12px;
            border-radius: 8px;
            margin: 12px 0;
        }

        .report-success {
            background: #d1f2eb;
            border: 1px solid #a3e4d7;
            color: #0e6b56;
            padding: 12px;
            border-radius: 8px;
            margin: 12px 0;
        }

        /* æŠ¥å‘Šä¿¡æ¯å¡ç‰‡æ ·å¼ */
        .report-info-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            border-left: 4px solid #10b981;
        }

        .report-type-badge {
            display: inline-block;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
            padding: 6px 12px;
            font-size: 12px;
            font-weight: 500;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: absolute;
            top: 0;
            right: 0;
            border-radius: 0;
            border-bottom-left-radius: 8px;
            transform: translateX(0);
            z-index: 10;
        }

        .report-date {
            color: #6b7280;
            font-size: 14px;
            margin-bottom: 8px;
        }

        .report-period {
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 8px;
        }

        /* æµ®åŠ¨å¯¹è¯æ¡†æ ·å¼ */
        .chat-float-container {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: white;
            padding: 12px;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
            border: none;
            border-radius: 0px 0px 0 0;
            transform: translateZ(0);
        }

        .chat-buttons-wrapper {
            display: flex;
            gap: 12px;
            align-items: center;
            justify-content: center;
            max-width: 400px;
            margin: 0 auto;
        }

        .chat-float {
            background: #667eea;
            color: white;
            padding: 14px 24px;
            border-radius: 32px;
            font-size: 15px;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 16px rgba(102, 126, 234, 0.3);
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
            flex: 1;
            border: none;
            min-height: 48px;
        }

        /* å¾®ä¿¡ç»¿è‰²æ ·å¼ */
        .chat-float.wechat-green {
            background: #07C160;
            box-shadow: 0 4px 16px rgba(7, 193, 96, 0.3);
        }

        .chat-float:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .chat-float.wechat-green:hover {
            box-shadow: 0 6px 20px rgba(7, 193, 96, 0.4);
        }

        .chat-float:active {
            transform: translateY(0);
        }

        .chat-float i {
            margin-right: 8px;
            font-size: 16px;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .medical-report-card {
                padding: 16px;
                margin-bottom: 16px;
            }

            .report-content h1 { font-size: 20px; }
            .report-content h2 { font-size: 18px; }
            .report-content h3 { font-size: 16px; }

            .media-video {
                height: 180px;
            }

            .report-highlight, .report-warning, .report-success {
                padding: 10px;
                font-size: 14px;
            }

            .chat-float {
                padding: 12px 16px;
                font-size: 14px;
                min-height: 44px;
            }

            .chat-float i {
                font-size: 14px;
                margin-right: 6px;
            }
        }

        /* åŠ è½½åŠ¨ç”» */
        .report-loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            color: #6b7280;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #e5e7eb;
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 12px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* æŠ¥å‘Šå†…å®¹è¡¨æ ¼æ ·å¼ */
        .report-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 16px 0;
        }

        .report-content th,
        .report-content td {
            border: 1px solid #e5e7eb;
            padding: 8px 12px;
            text-align: left;
        }

        .report-content th {
            background: #f9fafb;
            font-weight: 600;
            color: #1f2937;
        }

        .report-content tr:nth-child(even) {
            background: #f9fafb;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="step-container">
        <!-- å¤´éƒ¨ -->
        <div class="header">
            <div class="header-content">
                <button onclick="goBack()" class="back-btn">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <h1 class="header-title">AIå¥åº·æŠ¥å‘Š</h1>
                <div class="header-spacer"></div>
            </div>
        </div>

        <!-- å†…å®¹åŒºåŸŸ -->
        <div class="step-content">
            <!-- æŠ¥å‘ŠåŸºæœ¬ä¿¡æ¯å¡ç‰‡ -->
            <div class="report-info-card relative">
                <!-- å³ä¸Šè§’æ ‡ç­¾ -->
                <div class="report-type-badge" id="reportTypeBadge">å¥åº·å‘¨æŠ¥å‘Š</div>

                <!-- ä¸»è¦å†…å®¹ -->
                <div class="pt-6 pr-20">
                    <div class="report-period" id="reportPeriod">2024å¹´ç¬¬1å‘¨æŠ¥å‘Š</div>
                    <div class="report-date mt-1" id="reportDate">2024å¹´9æœˆ13æ—¥</div>
                </div>

                <!-- æŠ¥å‘Šæ¦‚è§ˆ -->
                <div class="bg-gray-50 rounded-lg p-3 mt-4">
                    <p class="text-sm text-gray-600" id="reportOverview">
                        æ ¹æ®æ‚¨æœ¬å‘¨çš„å¥åº·æ•°æ®åˆ†æï¼Œæ‚¨çš„æ•´ä½“å¥åº·çŠ¶å†µè‰¯å¥½ï¼Œè¡€å‹å’Œè¡€ç³–æ§åˆ¶è¾ƒä¸ºç¨³å®šï¼Œå»ºè®®ç»§ç»­ä¿æŒå½“å‰çš„ç”Ÿæ´»ä¹ æƒ¯ã€‚
                    </p>
                </div>
            </div>

            <!-- å¤šåª’ä½“å¥åº·æŠ¥å‘Š -->
            <div class="mb-6">
                <div class="medical-report-card">
                    <div id="reportContent" class="report-content">
                        <!-- è¿™é‡Œå°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½markdownå†…å®¹ -->
                    </div>
                </div>
            </div>
        </div>

        <!-- æµ®åŠ¨å¯¹è¯æ¡† - åº•éƒ¨æŒ‰é’® -->
        <div class="chat-float-container">
            <div class="chat-buttons-wrapper">
                <div class="chat-float wechat-green" onclick="openChat()">
                    <i class="fas fa-comments"></i>
                    è”ç³»å®¢æœ
                </div>
                <div class="chat-float" onclick="openConsultation()">
                    <i class="fas fa-user-md"></i>
                    çº¿ä¸Šé—®è¯Š
                </div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let reportData = null;

        // é¡µé¢åˆå§‹åŒ–
        function initializePage() {
            // è·å–URLå‚æ•°
            const urlParams = new URLSearchParams(window.location.search);
            const reportId = urlParams.get('reportId');
            const reportType = urlParams.get('type') || 'weekly';

            // æ¨¡æ‹ŸåŠ è½½æŠ¥å‘Šæ•°æ®
            loadReportData(reportId, reportType);
        }

        // åŠ è½½æŠ¥å‘Šæ•°æ®
        function loadReportData(reportId, type) {
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            const reportContent = document.getElementById('reportContent');
            reportContent.innerHTML = `
                <div class="report-loading">
                    <div class="loading-spinner"></div>
                    <span>æ­£åœ¨åŠ è½½æŠ¥å‘Š...</span>
                </div>
            `;

            // æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚å»¶è¿Ÿ
            setTimeout(() => {
                reportData = generateMockReportData(type);
                updateReportInfo();
                renderReportContent();
            }, 1000);
        }

        // è·å–å‘¨æ•°ï¼ˆä¸ai_report.htmlä¿æŒä¸€è‡´ï¼‰
        function getWeekNumber(date) {
            const firstDayOfYear = new Date(date.getFullYear(), 0, 1);
            const pastDaysOfYear = (date - firstDayOfYear) / 86400000;
            return Math.ceil((pastDaysOfYear + firstDayOfYear.getDay() + 1) / 7);
        }

        // ç”Ÿæˆæ¨¡æ‹ŸæŠ¥å‘Šæ•°æ®
        function generateMockReportData(type) {
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth() + 1;

            const baseData = {
                id: `report_${Date.now()}`,
                type: type,
                date: now,
                overview: 'æ ¹æ®æ‚¨æœ¬å‘¨çš„å¥åº·æ•°æ®åˆ†æï¼Œæ‚¨çš„æ•´ä½“å¥åº·çŠ¶å†µè‰¯å¥½ï¼Œè¡€å‹å’Œè¡€ç³–æ§åˆ¶è¾ƒä¸ºç¨³å®šï¼Œå»ºè®®ç»§ç»­ä¿æŒå½“å‰çš„ç”Ÿæ´»ä¹ æƒ¯ã€‚'
            };

            switch(type) {
                case 'weekly':
                    // è®¡ç®—å½“å‰æ˜¯ç¬¬å‡ å‘¨
                    const weekNumber = getWeekNumber(now);
                    return {
                        ...baseData,
                        title: `${year}å¹´ç¬¬${weekNumber}å‘¨å¥åº·æŠ¥å‘Š`,
                        typeLabel: 'å‘¨æŠ¥å‘Š',
                        period: `${year}å¹´ç¬¬${weekNumber}å‘¨æŠ¥å‘Š`,
                        weekNumber: weekNumber,
                        content: generateWeeklyReportContent()
                    };
                case 'monthly':
                    return {
                        ...baseData,
                        title: `${year}å¹´${month}æœˆå¥åº·æŠ¥å‘Š`,
                        typeLabel: 'æœˆæŠ¥å‘Š',
                        period: `${year}å¹´${month}æœˆ`,
                        content: generateMonthlyReportContent()
                    };
                case 'yearly':
                    return {
                        ...baseData,
                        title: `${year}å¹´å¥åº·æŠ¥å‘Š`,
                        typeLabel: 'å¹´æŠ¥å‘Š',
                        period: `${year}å¹´`,
                        content: generateYearlyReportContent()
                    };
                default:
                    return baseData;
            }
        }

        // ç”Ÿæˆå‘¨æŠ¥å‘Šå†…å®¹
        function generateWeeklyReportContent() {
            const now = new Date();
            const weekNumber = getWeekNumber(now);
            return `
## ç¬¬${weekNumber}å‘¨å¥åº·æ•°æ®æ€»è§ˆ

æœ¬å‘¨æ‚¨çš„å¥åº·ç›‘æµ‹æ•°æ®æ˜¾ç¤ºï¼Œæ‚¨çš„æ•´ä½“å¥åº·çŠ¶å†µè‰¯å¥½ã€‚å„é¡¹å…³é”®æŒ‡æ ‡éƒ½æ§åˆ¶åœ¨åˆç†èŒƒå›´å†…ï¼Œè¿™è¡¨æ˜æ‚¨å½“å‰çš„å¥åº·ç®¡ç†ç­–ç•¥æ˜¯æœ‰æ•ˆçš„ã€‚

### ğŸ“Š ä¸»è¦å¥åº·æŒ‡æ ‡

| æŒ‡æ ‡ | å¹³å‡å€¼ | çŠ¶æ€ | è¶‹åŠ¿ |
|------|--------|------|------|
| è¡€ç³– | 6.2 mmol/L | âœ… æ­£å¸¸ | ğŸ“‰ ç¨³å®š |
| è¡€å‹ | 120/80 mmHg | âœ… æ­£å¸¸ | â¡ï¸ å¹³ç¨³ |
| å¿ƒç‡ | 72 bpm | âœ… æ­£å¸¸ | ğŸ“‰ ç¨³å®š |

<div class="report-success">
âœ… **æ­å–œæ‚¨**ï¼šæœ¬å‘¨æ‰€æœ‰æŒ‡æ ‡éƒ½åœ¨æ­£å¸¸èŒƒå›´å†…ï¼
</div>

## è¡€ç³–è¯¦ç»†åˆ†æ

### ğŸ“ˆ è¡€ç³–è¶‹åŠ¿
- **ç©ºè…¹è¡€ç³–**ï¼šå¹³å‡ 5.8 mmol/Lï¼Œæ§åˆ¶è‰¯å¥½
- **é¤åè¡€ç³–**ï¼šå¹³å‡ 7.2 mmol/Lï¼Œåœ¨ç†æƒ³èŒƒå›´å†…
- **è¡€ç³–æ³¢åŠ¨**ï¼šæ ‡å‡†å·® 1.2ï¼Œæ³¢åŠ¨è¾ƒå°

### ğŸ’¡ è¡€ç³–ç®¡ç†å»ºè®®
1. **ç»§ç»­å½“å‰çš„é¥®é£Ÿæ§åˆ¶æ–¹æ¡ˆ**
2. **ä¿æŒè§„å¾‹çš„è¿åŠ¨ä¹ æƒ¯**
3. **å®šæœŸç›‘æµ‹è¡€ç³–å˜åŒ–**

## è¡€å‹ç›‘æµ‹ç»“æœ

æœ¬å‘¨è¡€å‹ç›‘æµ‹ç»“æœæ˜¾ç¤ºæ‚¨çš„è¡€å‹æ§åˆ¶ç†æƒ³ï¼š
- **æ”¶ç¼©å‹å¹³å‡**ï¼š120 mmHg
- **èˆ’å¼ å‹å¹³å‡**ï¼š80 mmHg
- **è¡€å‹å˜å¼‚æ€§**ï¼šä½ï¼Œè¯´æ˜è¡€å‹ç¨³å®š

### ğŸ¯ è¡€å‹ç®¡ç†è¦ç‚¹
- ä½ç›é¥®é£Ÿï¼Œæ¯æ—¥é£Ÿç›æ‘„å…¥é‡æ§åˆ¶åœ¨6gä»¥å†…
- ä¿æŒé€‚å½“çš„ä½“é‡
- è§„å¾‹çš„æœ‰æ°§è¿åŠ¨

## ç”Ÿæ´»æ–¹å¼è¯„ä¼°

### ğŸ é¥®é£Ÿæƒ…å†µ
- **é¥®é£Ÿè§„å¾‹æ€§**ï¼šè‰¯å¥½
- **è¥å…»å‡è¡¡**ï¼šåŸºæœ¬åˆç†
- **æ§ç³–æ•ˆæœ**ï¼šæ˜æ˜¾

### ğŸƒâ€â™‚ï¸ è¿åŠ¨æƒ…å†µ
- **è¿åŠ¨é¢‘ç‡**ï¼šæ¯å‘¨4-5æ¬¡
- **è¿åŠ¨æ—¶é•¿**ï¼šæ¯æ¬¡30-45åˆ†é’Ÿ
- **è¿åŠ¨å¼ºåº¦**ï¼šä¸­ç­‰

### ğŸ˜´ ç¡çœ è´¨é‡
- **ç¡çœ æ—¶é•¿**ï¼šå¹³å‡7-8å°æ—¶
- **ç¡çœ è´¨é‡**ï¼šè‰¯å¥½
- **è§„å¾‹ä½œæ¯**ï¼šæ˜¯

## ä¸‹å‘¨å¥åº·å»ºè®®

### ğŸ¯ é‡ç‚¹æ”¹è¿›æ–¹å‘
1. **å¢åŠ è”¬èœæ‘„å…¥é‡**ï¼Œå»ºè®®æ¯æ—¥500gä»¥ä¸Š
2. **ä¼˜åŒ–è¿›é¤æ—¶é—´**ï¼Œé¿å…æ™šé¤è¿‡æ™š
3. **å¢åŠ åŠ›é‡è®­ç»ƒ**ï¼Œæé«˜è‚Œè‚‰é‡

### âš ï¸ æ³¨æ„äº‹é¡¹
- ç»§ç»­ç›‘æµ‹è¡€ç³–å˜åŒ–
- ä¿æŒå½“å‰çš„æ²»ç–—æ–¹æ¡ˆ
- å¦‚æœ‰ä¸é€‚åŠæ—¶å°±åŒ»

## ä¸“å®¶æé†’

> ğŸ’¡ **åŒ»ç”Ÿå»ºè®®**ï¼šæ‚¨æœ¬å‘¨çš„å¥åº·çŠ¶å†µæ•´ä½“è‰¯å¥½ï¼Œè¯·ç»§ç»­ä¿æŒå½“å‰çš„å¥åº·ç®¡ç†æ–¹å¼ã€‚å®šæœŸä½“æ£€å’ŒæŒç»­ç›‘æµ‹æ˜¯ç»´æŠ¤å¥åº·çš„å…³é”®ã€‚

---

**æœ¬æŠ¥å‘Šç”±ä¼˜å”AIå¥åº·åŠ©æ‰‹ç”Ÿæˆï¼Œä»…ä¾›å‚è€ƒã€‚å¦‚æœ‰å¥åº·é—®é¢˜è¯·å’¨è¯¢ä¸“ä¸šåŒ»ç”Ÿã€‚**
            `;
        }

        // ç”ŸæˆæœˆæŠ¥å‘Šå†…å®¹
        function generateMonthlyReportContent() {
            return `
## æœ¬æœˆå¥åº·æ•°æ®æ€»ç»“

æœ¬æœˆæ‚¨çš„å¥åº·ç®¡ç†æ•ˆæœæ˜¾è‘—ï¼Œå„é¡¹æŒ‡æ ‡éƒ½æ§åˆ¶åœ¨ç†æƒ³èŒƒå›´å†…ã€‚é€šè¿‡æŒç»­çš„å¥åº·ç›‘æµ‹å’Œç®¡ç†ï¼Œæ‚¨çš„å¥åº·çŠ¶å†µå‘ˆç°ç¨³æ­¥æ”¹å–„çš„è¶‹åŠ¿ã€‚

### ğŸ“Š æœˆåº¦å¥åº·æŒ‡æ ‡ç»Ÿè®¡

| æŒ‡æ ‡ | èŒƒå›´ | å¹³å‡å€¼ | è¾¾æ ‡ç‡ | è¶‹åŠ¿ |
|------|------|--------|--------|------|
| è¡€ç³– | 4.4-7.8 | 6.1 mmol/L | 92% | ğŸ“‰ æ”¹å–„ |
| è¡€å‹ | 90-140 | 118/78 | 95% | ğŸ“‰ æ”¹å–„ |
| å¿ƒç‡ | 60-100 | 70 | 98% | â¡ï¸ ç¨³å®š |

<div class="report-highlight">
ğŸ¯ **æœ¬æœˆæˆå°±**ï¼šæ‚¨çš„è¡€ç³–è¾¾æ ‡ç‡è¾¾åˆ°92%ï¼Œè¡€å‹è¾¾æ ‡ç‡è¾¾åˆ°95%ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸ä¼˜ç§€çš„æˆç»©ï¼
</div>

## è¡€ç³–æœˆåº¦åˆ†æ

### ğŸ“ˆ è¡€ç³–æ§åˆ¶è¶‹åŠ¿
æœ¬æœˆè¡€ç³–æ§åˆ¶å‘ˆç°æŒç»­æ”¹å–„è¶‹åŠ¿ï¼š
- **ç¬¬1å‘¨**ï¼šå¹³å‡ 6.5 mmol/Lï¼Œè¾¾æ ‡ç‡ 85%
- **ç¬¬2å‘¨**ï¼šå¹³å‡ 6.3 mmol/Lï¼Œè¾¾æ ‡ç‡ 89%
- **ç¬¬3å‘¨**ï¼šå¹³å‡ 6.1 mmol/Lï¼Œè¾¾æ ‡ç‡ 92%
- **ç¬¬4å‘¨**ï¼šå¹³å‡ 5.9 mmol/Lï¼Œè¾¾æ ‡ç‡ 96%

### ğŸ é¥®é£Ÿç®¡ç†æˆæ•ˆ
- **ç¢³æ°´åŒ–åˆç‰©æ§åˆ¶**ï¼šä¼˜ç§€
- **è›‹ç™½è´¨æ‘„å…¥**ï¼šåˆç†
- **è„‚è‚ªæ‘„å…¥**ï¼šé€‚ä¸­
- **çº¤ç»´ç´ æ‘„å…¥**ï¼šå……è¶³

## è¡€å‹æœˆåº¦è¯„ä¼°

æœ¬æœˆè¡€å‹æ§åˆ¶è‰¯å¥½ï¼Œæ³¢åŠ¨èŒƒå›´å°ï¼š
- **æœ€é«˜è¡€å‹**ï¼š135/85 mmHg
- **æœ€ä½è¡€å‹**ï¼š110/70 mmHg
- **å¹³å‡è¡€å‹**ï¼š118/78 mmHg

### ğŸ’¡ è¡€å‹ç®¡ç†è¦ç‚¹
- é™åˆ¶é’ ç›æ‘„å…¥æ•ˆæœæ˜¾è‘—
- è¿åŠ¨å¯¹è¡€å‹æ§åˆ¶èµ·åˆ°ç§¯æä½œç”¨
- ä½“é‡ç®¡ç†å¯¹è¡€å‹æ”¹å–„æœ‰è´¡çŒ®

## ç”Ÿæ´»æ–¹å¼å…¨é¢è¯„ä¼°

### ğŸƒâ€â™‚ï¸ è¿åŠ¨ä¹ æƒ¯
- **è¿åŠ¨æ€»å¤©æ•°**ï¼š26å¤©
- **æ€»è¿åŠ¨æ—¶é•¿**ï¼š20.8å°æ—¶
- **å¹³å‡æ¯æ—¥è¿åŠ¨**ï¼š48åˆ†é’Ÿ
- **è¿åŠ¨ç±»å‹åˆ†å¸ƒ**ï¼šæœ‰æ°§è¿åŠ¨70%ï¼ŒåŠ›é‡è®­ç»ƒ30%

### ğŸ˜´ ç¡çœ è´¨é‡
- **å¹³å‡ç¡çœ æ—¶é•¿**ï¼š7.5å°æ—¶
- **æ·±åº¦ç¡çœ æ¯”ä¾‹**ï¼š22%
- **ç¡çœ æ•ˆç‡**ï¼š92%
- **å…¥ç¡å›°éš¾æ¬¡æ•°**ï¼š0æ¬¡

### ğŸ§˜â€â™€ï¸ å‹åŠ›ç®¡ç†
- **å‹åŠ›æ°´å¹³**ï¼šä½
- **æ”¾æ¾æ´»åŠ¨é¢‘ç‡**ï¼šæ¯å‘¨3-4æ¬¡
- **å†¥æƒ³ç»ƒä¹ **ï¼šæ¯å‘¨2æ¬¡

## ä¸‹æœˆå¥åº·ç®¡ç†è®¡åˆ’

### ğŸ¯ é‡ç‚¹ç›®æ ‡
1. **è¡€ç³–**ï¼šè¿›ä¸€æ­¥é™ä½è‡³ 5.8 mmol/L ä»¥ä¸‹
2. **è¡€å‹**ï¼šç»´æŒåœ¨ 115/75 mmHg å·¦å³
3. **ä½“é‡**ï¼šç»§ç»­å‡é‡ 2-3kg

### ğŸ“‹ å…·ä½“æªæ–½
- **é¥®é£Ÿè°ƒæ•´**ï¼šå¢åŠ ä¼˜è´¨è›‹ç™½è´¨ï¼Œå‡å°‘ç²¾åˆ¶ç³–
- **è¿åŠ¨å‡çº§**ï¼šå¢åŠ é«˜å¼ºåº¦é—´æ­‡è®­ç»ƒ
- **ç›‘æµ‹é¢‘ç‡**ï¼šä¿æŒæ¯æ—¥è¡€ç³–ç›‘æµ‹

### âš ï¸ é£é™©é¢„è­¦
- æ³¨æ„å­£èŠ‚å˜åŒ–å¯¹è¡€ç³–çš„å½±å“
- é¢„é˜²æ„Ÿå†’ç­‰ç–¾ç—…å¯¹å¥åº·çš„å¹²æ‰°
- å®šæœŸå¤æŸ¥ç›¸å…³æŒ‡æ ‡

---

**æ„Ÿè°¢æ‚¨å¯¹å¥åº·ç®¡ç†çš„åšæŒï¼æ‚¨çš„åŠªåŠ›æ­£åœ¨å¾—åˆ°å›æŠ¥ã€‚**
            `;
        }

        // ç”Ÿæˆå¹´æŠ¥å‘Šå†…å®¹
        function generateYearlyReportContent() {
            return `
## å¹´åº¦å¥åº·çŠ¶å†µæ€»ç»“æŠ¥å‘Š

æ­å–œæ‚¨ï¼è¿‡å»ä¸€å¹´çš„å¥åº·æ•°æ®æ˜¾ç¤ºï¼Œæ‚¨çš„å¥åº·çŠ¶å†µå¾—åˆ°äº†æ˜¾è‘—æ”¹å–„ã€‚é€šè¿‡ç§‘å­¦çš„ç®¡ç†å’ŒæŒç»­çš„åŠªåŠ›ï¼Œæ‚¨çš„å„é¡¹å¥åº·æŒ‡æ ‡éƒ½è¾¾åˆ°äº†ç†æƒ³æ°´å¹³ã€‚

### ğŸ† å¹´åº¦å¥åº·æˆå°±

<div class="report-highlight">
ğŸ‰ **å¹´åº¦äº®ç‚¹**ï¼šç›¸æ¯”å»å¹´ï¼Œæ‚¨çš„è¡€ç³–æ§åˆ¶æå‡äº†35%ï¼Œè¡€å‹æ§åˆ¶æå‡äº†28%ï¼Œæ•´ä½“å¥åº·æ°´å¹³è¾¾åˆ°äº†è¿‘5å¹´æœ€ä½³çŠ¶æ€ï¼
</div>

### ğŸ“Š å¹´åº¦å¥åº·æŒ‡æ ‡å¯¹æ¯”

| æŒ‡æ ‡ | å»å¹´å¹³å‡ | ä»Šå¹´å¹³å‡ | æ”¹å–„å¹…åº¦ | è¯„çº§ |
|------|----------|----------|----------|------|
| ç©ºè…¹è¡€ç³– | 7.2 | 5.8 | ğŸ“‰ 19% | ä¼˜ç§€ |
| é¤åè¡€ç³– | 9.5 | 7.1 | ğŸ“‰ 25% | ä¼˜ç§€ |
| æ”¶ç¼©å‹ | 135 | 118 | ğŸ“‰ 13% | è‰¯å¥½ |
| èˆ’å¼ å‹ | 88 | 78 | ğŸ“‰ 11% | è‰¯å¥½ |
| ä½“é‡ | 75kg | 68kg | ğŸ“‰ 9% | è‰¯å¥½ |

## å­£åº¦å¥åº·çŠ¶å†µåˆ†æ

### ğŸŒ¸ æ˜¥å­£ (3-5æœˆ)
- **ç‰¹ç‚¹**ï¼šè¡€ç³–å¼€å§‹æ”¹å–„ï¼Œè¡€å‹ç¨³å®š
- **æˆç»©**ï¼šè¡€ç³–è¾¾æ ‡ç‡ä»65%æå‡è‡³78%
- **å…³é”®å› ç´ **ï¼šå¤©æ°”è½¬æš–ï¼Œè¿åŠ¨é‡å¢åŠ 

### â˜€ï¸ å¤å­£ (6-8æœˆ)
- **ç‰¹ç‚¹**ï¼šå„é¡¹æŒ‡æ ‡æ§åˆ¶æœ€ä½³
- **æˆç»©**ï¼šè¡€ç³–è¾¾æ ‡ç‡è¾¾åˆ°90%ï¼Œè¡€å‹ç¨³å®šåœ¨120/80ä»¥ä¸‹
- **å…³é”®å› ç´ **ï¼šæ–°é²œè”¬æœä¸°å¯Œï¼Œæˆ·å¤–æ´»åŠ¨å¢åŠ 

### ğŸ‚ ç§‹å­£ (9-11æœˆ)
- **ç‰¹ç‚¹**ï¼šä¿æŒç¨³å®šï¼Œç•¥æœ‰æ³¢åŠ¨
- **æˆç»©**ï¼šè¡€ç³–è¾¾æ ‡ç‡88%ï¼Œè¡€å‹æ§åˆ¶è‰¯å¥½
- **å…³é”®å› ç´ **ï¼šæ³¨æ„é¥®é£Ÿè°ƒæ•´ï¼Œåº”å¯¹å­£èŠ‚å˜åŒ–

### â„ï¸ å†¬å­£ (12-2æœˆ)
- **ç‰¹ç‚¹**ï¼šé¢ä¸´æŒ‘æˆ˜ï¼Œéœ€è¦é¢å¤–å…³æ³¨
- **æˆç»©**ï¼šè¡€ç³–è¾¾æ ‡ç‡82%ï¼Œè¡€å‹ç•¥æœ‰ä¸Šå‡
- **å…³é”®å› ç´ **ï¼šå®¤å†…è¿åŠ¨å¢åŠ ï¼Œé¥®é£Ÿæ§åˆ¶åŠ å¼º

## ç”Ÿæ´»æ–¹å¼å¹´åº¦å˜åŒ–

### ğŸ é¥®é£Ÿä¹ æƒ¯çš„å·¨å¤§æ”¹å–„
- **ç³–åˆ†æ‘„å…¥**ï¼šå‡å°‘ 60%
- **è”¬èœæ‘„å…¥**ï¼šå¢åŠ  120%
- **å…¨è°·ç‰©æ‘„å…¥**ï¼šå¢åŠ  200%
- **ä¼˜è´¨è›‹ç™½**ï¼šå¢åŠ  80%

### ğŸƒâ€â™‚ï¸ è¿åŠ¨ä¹ æƒ¯çš„å…»æˆ
- **è¿åŠ¨é¢‘ç‡**ï¼šä»æ¯å‘¨1-2æ¬¡æå‡è‡³5-6æ¬¡
- **è¿åŠ¨å¤šæ ·æ€§**ï¼šä»å•ä¸€æ­¥è¡Œå‘å±•ä¸ºæœ‰æ°§+åŠ›é‡+æŸ”éŸ§è®­ç»ƒ
- **è¿åŠ¨æ—¶é•¿**ï¼šä»å¹³å‡20åˆ†é’Ÿæå‡è‡³50åˆ†é’Ÿ

### ğŸ˜´ ç¡çœ è´¨é‡çš„æ˜¾è‘—æå‡
- **å¹³å‡ç¡çœ æ—¶é•¿**ï¼šä»6.2å°æ—¶å¢åŠ è‡³7.8å°æ—¶
- **ç¡çœ è´¨é‡è¯„åˆ†**ï¼šä»6.5åˆ†æå‡è‡³8.8åˆ†
- **è§„å¾‹ä½œæ¯**ï¼šå»ºç«‹äº†ç¨³å®šçš„ç”Ÿç‰©é’Ÿ

## å¥åº·é£é™©é™ä½æƒ…å†µ

### ğŸ›¡ï¸ ç³–å°¿ç—…å¹¶å‘ç—‡é£é™©
- **å¿ƒè¡€ç®¡ç–¾ç—…é£é™©**ï¼šé™ä½ 45%
- **è‚¾ç—…é£é™©**ï¼šé™ä½ 38%
- **ç¥ç»ç—…å˜é£é™©**ï¼šé™ä½ 42%
- **è§†ç½‘è†œç—…å˜é£é™©**ï¼šé™ä½ 35%

### ğŸ’ª å¿ƒè¡€ç®¡å¥åº·çŠ¶å†µ
- **10å¹´å¿ƒè¡€ç®¡é£é™©è¯„ä¼°**ï¼šä»é«˜é£é™©é™è‡³ä½é£é™©
- **è¡€è„‚æ°´å¹³**ï¼šå…¨é¢æ”¹å–„
- **è¡€ç®¡å¼¹æ€§**ï¼šæ˜¾è‘—æå‡

## æ˜å¹´å¥åº·ç®¡ç†è§„åˆ’

### ğŸ¯ å¹´åº¦å¥åº·ç›®æ ‡
1. **è¡€ç³–æ§åˆ¶**ï¼šç»´æŒå½“å‰ä¼˜ç§€æ°´å¹³ï¼Œè¿›ä¸€æ­¥æå‡ç¨³å®šæ€§
2. **ä½“é‡ç®¡ç†**ï¼šè¾¾åˆ°ç†æƒ³ä½“é‡65kgå¹¶ä¿æŒ
3. **ä½“èƒ½æå‡**ï¼šå®ŒæˆåŠç¨‹é©¬æ‹‰æ¾æŒ‘æˆ˜
4. **è¥å…»ä¼˜åŒ–**ï¼šå­¦ä¹ æ›´å¤šè¥å…»çŸ¥è¯†ï¼Œä¼˜åŒ–é¥®é£Ÿç»“æ„

### ğŸ“‹ å…·ä½“è¡ŒåŠ¨è®¡åˆ’
- **ç¬¬ä¸€å­£åº¦**ï¼šå»ºç«‹æ›´å®Œå–„çš„å¥åº·ç›‘æµ‹ä½“ç³»
- **ç¬¬äºŒå­£åº¦**ï¼šæŒ‘æˆ˜æ–°çš„è¿åŠ¨ç›®æ ‡
- **ç¬¬ä¸‰å­£åº¦**ï¼šæ·±åŒ–è¥å…»çŸ¥è¯†å­¦ä¹ 
- **ç¬¬å››å­£åº¦**ï¼šå¹´åº¦æ€»ç»“å’Œæ–°ç›®æ ‡è®¾å®š

### ğŸŒŸ é•¿è¿œå¥åº·æ„¿æ™¯
æ‚¨çš„åŠªåŠ›è¯æ˜äº†å¥åº·ç®¡ç†çš„é‡è¦æ€§å’Œæœ‰æ•ˆæ€§ã€‚ç»§ç»­ä¿æŒè¿™ç§è‰¯å¥½çš„ç”Ÿæ´»ä¹ æƒ¯ï¼Œæ‚¨å°†æ‹¥æœ‰æ›´åŠ å¥åº·ã€å……æ»¡æ´»åŠ›çš„ç”Ÿæ´»ï¼

---

**ç¥è´ºæ‚¨è¿‡å»ä¸€å¹´çš„ä¼˜å¼‚è¡¨ç°ï¼æ‚¨çš„å¥åº·å°±æ˜¯æœ€å¤§çš„è´¢å¯Œã€‚ç»§ç»­åŠ æ²¹ï¼**
            `;
        }

        // æ›´æ–°æŠ¥å‘Šä¿¡æ¯
        function updateReportInfo() {
            if (!reportData) return;

            document.getElementById('reportTypeBadge').textContent = reportData.typeLabel;
            document.getElementById('reportDate').textContent = formatDate(reportData.date);
            document.getElementById('reportPeriod').textContent = reportData.period;
            document.getElementById('reportOverview').textContent = reportData.overview;
        }

        // æ¸²æŸ“æŠ¥å‘Šå†…å®¹
        function renderReportContent() {
            if (!reportData) return;

            const reportContainer = document.getElementById('reportContent');
            const html = marked.parse(reportData.content);
            reportContainer.innerHTML = html;

            // å¤„ç†åª’ä½“å…ƒç´ 
            processMediaElements(reportContainer);
        }

        // å¤„ç†åª’ä½“å…ƒç´ 
        function processMediaElements(container) {
            // å¤„ç†è¡¨æ ¼
            const tables = container.querySelectorAll('table');
            tables.forEach(table => {
                table.className = 'w-full text-sm';
                const headers = table.querySelectorAll('th');
                const cells = table.querySelectorAll('td');

                headers.forEach(header => {
                    header.className = 'px-4 py-2 text-left font-medium text-gray-700 bg-gray-50';
                });

                cells.forEach(cell => {
                    cell.className = 'px-4 py-2 border-t border-gray-200';
                });
            });

            // ä»£ç é«˜äº®
            if (typeof hljs !== 'undefined') {
                hljs.highlightAll();
            }
        }

        // æ ¼å¼åŒ–æ—¥æœŸ
        function formatDate(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}å¹´${month}æœˆ${day}æ—¥`;
        }

        // è¿”å›ä¸Šä¸€é¡µ
        function goBack() {
            if (window.parent !== window) {
                window.parent.postMessage({
                    type: 'navigate',
                    page: 'ai_report'
                }, '*');
            } else {
                window.location.href = 'ai_report.html';
            }
        }

        // æ‰“å¼€èŠå¤©
        function openChat() {
            if (window.parent !== window) {
                window.parent.postMessage({
                    type: 'navigate',
                    page: 'chat'
                }, '*');
            } else {
                window.location.href = 'chat.html';
            }
        }

        // æ‰“å¼€çº¿ä¸Šé—®è¯Š
        function openConsultation() {
            if (window.parent !== window) {
                window.parent.postMessage({
                    type: 'navigate',
                    page: 'consultation'
                }, '*');
            } else {
                window.location.href = 'consultation.html';
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initializePage();
        });
    </script>

    <!-- å…¨å±€é”™è¯¯å¤„ç† -->
    <script>
        window.addEventListener('error', function(e) {
            console.error('JavaScript Error:', e.message);
            // é˜»æ­¢é”™è¯¯å¼¹çª—ï¼Œä½†ä¸å½±å“é¡µé¢æ˜¾ç¤º
            return true;
        });

        // å®‰å…¨çš„getElementByIdåŒ…è£…å‡½æ•°
        function safeGetElement(id) {
            return document.getElementById(id);
        }

        // å®‰å…¨çš„textContentè®¾ç½®å‡½æ•°
        function safeSetText(id, text) {
            const element = document.getElementById(id);
            if (element && text !== undefined && text !== null) {
                element.textContent = text;
            }
            return element;
        }
        // å®‰å…¨çš„éœ‡åŠ¨å‡½æ•°ï¼ˆé¿å…iframeä¸­çš„è·¨åŸŸé™åˆ¶ï¼‰
        function safeVibrate(duration) {
            try {
                // æ£€æŸ¥æ˜¯å¦æ”¯æŒéœ‡åŠ¨API
                if (navigator.vibrate && window.self === window.top) {
                    navigator.vibrate(duration);
                }
            } catch (e) {
                // å¿½ç•¥éœ‡åŠ¨APIé”™è¯¯
                console.debug('Vibrate not available:', e.message);
            }
        }

    </script>
</body>
</html>