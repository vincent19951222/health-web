<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>修改密码 - 优唐智能AI+</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* 糖尿病控糖管理平台 - 统一样式文件 */

        /* 颜色定义 */
        .colors {
            /* 主色调 */
            color: #3b82f6; /* 原 --primary-color: #667eea 改为蓝色 */
            color: #2563eb; /* 原 --primary-dark: #5a67d8 改为深蓝色 */
            color: #8b5cf6; /* 原 --secondary-color: #764ba2 改为紫色 */

            /* 医疗主题色彩 */
            color: #3b82f6; /* --medical-blue */
            color: #10b981; /* --medical-green */
            color: #ef4444; /* --medical-red */
            color: #f59e0b; /* --medical-orange */
            color: #8b5cf6; /* --medical-purple */

            /* 中性色 */
            color: #f9fafb; /* --gray-50 */
            color: #f3f4f6; /* --gray-100 */
            color: #e5e7eb; /* --gray-200 */
            color: #d1d5db; /* --gray-300 */
            color: #9ca3af; /* --gray-400 */
            color: #6b7280; /* --gray-500 */
            color: #4b5563; /* --gray-600 */
            color: #374151; /* --gray-700 */
            color: #1f2937; /* --gray-800 */
            color: #111827; /* --gray-900 */
        }

        /* 全局重置和基础样式 */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        /* 隐藏所有滚动条 - 移动端优化 */
        * {
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* IE and Edge */
        }

        /* 隐藏Webkit浏览器滚动条 */
        *::-webkit-scrollbar {
            display: none;
        }

        /* 确保页面不会出现横向滚动 */
        html, body {
            overflow-x: hidden;
            max-width: 100vw;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #1f2937;
            background-color: #f9fafb;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* 按钮样式增强 */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 14px;
            line-height: 20px;
            text-decoration: none;
            border: none;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        /* 保存按钮样式 */
        .btn-save {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 16px 32px;
            border-radius: 9999px;
            font-weight: 700;
            font-size: 18px;
            line-height: 24px;
            text-decoration: none;
            border: none;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-save-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .btn-save-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        .btn-save-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: white;
            color: #3b82f6;
            border: 2px solid #3b82f6;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }

        .btn-secondary:hover {
            background: #3b82f6;
            color: white;
            transform: translateY(-1px);
        }

        /* 输入框样式增强 */
        .form-input {
            width: 100%;
            padding: 10px 10px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 14px;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            background: white;
        }

        .form-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
            transform: translateY(-1px);
        }

        .form-input::placeholder {
            color: #9ca3af;
        }

        /* 底部导航栏样式 */
        .tab-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 83px;
            background: white;
            border-top: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: space-around;
            padding-bottom: 20px;
            z-index: 1000;
        }

        .tab-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 12px;
            position: relative;
        }

        .tab-item:hover {
            background: rgba(102, 126, 234, 0.1);
        }

        .tab-item.active {
            color: #667eea;
        }

        .tab-item i {
            font-size: 20px;
            margin-bottom: 2px;
            transition: all 0.3s ease;
        }

        .tab-item span {
            font-size: 10px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .tab-item.active i,
        .tab-item.active span {
            color: #667eea;
            transform: scale(1.1);
        }

        .tab-item:not(.active) i,
        .tab-item:not(.active) span {
            color: #9ca3af;
        }

        .tab-item.add-btn {
            background: #667eea;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 25px;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .tab-item.add-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
        }

        .tab-item.add-btn i {
            color: white;
            font-size: 24px;
            margin: 0;
        }

        /* 主内容区域样式 */
        .main-content {
            padding-bottom: 120px;
        }

        /* 倒计时样式 */
        .countdown {
            color: #6b7280;
            font-size: 14px;
            text-align: center;
            margin-top: 8px;
        }

        .countdown.active {
            color: #3b82f6;
        }

        /* 加载动画 */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid #e5e7eb;
            border-radius: 50%;
            border-top-color: #3b82f6;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* 响应式设计 */
        @media (max-width: 640px) {
            .main-content {
                padding: 16px;
            }

            .btn {
                padding: 10px 20px;
                font-size: 13px;
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="min-h-screen">
        <!-- 顶部导航栏 -->
        <div class="bg-white shadow-sm relative">
            <div class="flex items-center justify-between px-4 py-3">
                <button onclick="navigateBack()" class="text-gray-600 hover:text-gray-800">
                    <i class="fas fa-chevron-left text-lg"></i>
                </button>
                <h1 class="text-lg font-semibold text-gray-800 absolute left-1/2 transform -translate-x-1/2">修改密码</h1>
                <div class="w-6"></div> <!-- 占位符保持居中 -->
            </div>
        </div>

        <!-- 主内容区域 -->
        <div class="main-content">
            <div class="container mx-auto px-2 py-2 max-w-md">
                <!-- 提示信息 -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-2 mb-2">
                    <div class="flex items-start">
                        <i class="fas fa-info-circle text-blue-600 mt-0.5 mr-3"></i>
                        <div>
                            <p class="text-sm text-blue-600 mt-0">
                                使用账户、密码方式登录，可在此修改密码。手机号+验证码登录，更快捷。
                            </p>
                        </div>
                    </div>
                </div>

                <!-- 修改密码表单 -->
                <form onsubmit="handleSubmit(event)" class="space-y-4">
                    <!-- 新密码输入 -->
                    <div>
                        <label class="block text-md font-medium text-gray-700 mb-2">
                            <i class="fas fa-lock text-gray-400 mr-1"></i>
                            新密码
                        </label>
                        <input
                            type="password"
                            id="newPassword"
                            class="form-input"
                            placeholder="请输入新密码"
                            minlength="6"
                            maxlength="20"
                            required
                        >
                        <div class="mt-2 text-sm text-gray-500">
                            密码是6-20位的字母、数字、字符组合。
                        </div>
                    </div>

                    <!-- 确认密码输入 -->
                    <div>
                        <label class="block text-md font-medium text-gray-700 mb-2">
                            <i class="fas fa-lock text-gray-400 mr-1"></i>
                            确认新密码
                        </label>
                        <input
                            type="password"
                            id="confirmPassword"
                            class="form-input"
                            placeholder="请再次输入新密码"
                            minlength="6"
                            maxlength="20"
                            required
                        >
                        <div id="passwordMatchError" class="text-xs text-red-500 mt-1 hidden">
                            两次输入的密码不一致
                        </div>
                    </div>

                    <!-- 手机验证码输入 -->
                    <div>
                        <label class="block text-md font-medium text-gray-700 mb-2">
                            <i class="fas fa-mobile-alt text-gray-400 mr-1"></i>
                            手机验证码
                        </label>
                        <div class="flex gap-2">
                            <input
                                type="text"
                                id="verificationCode"
                                class="form-input flex-1"
                                placeholder="请输入验证码"
                                maxlength="6"
                                pattern="[0-9]{6}"
                                required
                            >
                            <button
                                type="button"
                                id="sendCodeBtn"
                                onclick="sendVerificationCode()"
                                class="btn btn-secondary px-4 py-2 whitespace-nowrap"
                            >
                                发送验证码
                            </button>
                        </div>
                        <div id="countdown" class="countdown">
                            验证码将发送至 138****8888
                        </div>
                    </div>

                    <!-- 提交按钮 -->
                    <div class="pt-0">
                        <button type="submit" class="btn-save btn-save-primary w-full">
                            保存
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 底部导航栏 -->
    <div class="tab-bar">
        <div class="tab-item" onclick="navigateToPage('home')">
            <i class="fas fa-home"></i>
            <span>首页</span>
        </div>
        <div class="tab-item" onclick="navigateToPage('chat')">
            <i class="fas fa-robot"></i>
            <span>问AI</span>
        </div>
        <div class="tab-item active" onclick="navigateToPage('profile')">
            <i class="fas fa-user"></i>
            <span>我的</span>
        </div>
    </div>

    <script>
        /**
         * 修改密码页面交互功能
         */

        // 全局变量
        let countdownTimer = null;
        let countdownSeconds = 60;

        /**
         * 工具函数
         */
        const Utils = {
            /**
             * 显示通知
             */
            showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm transform transition-all duration-300`;

                const colors = {
                    success: 'bg-green-500 text-white',
                    error: 'bg-red-500 text-white',
                    warning: 'bg-yellow-500 text-white',
                    info: 'bg-blue-500 text-white'
                };

                notification.className += ` ${colors[type] || colors.info}`;
                notification.innerHTML = `
                    <div class="flex items-center">
                        <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'} mr-2"></i>
                        <span>${message}</span>
                    </div>
                `;

                document.body.appendChild(notification);

                setTimeout(() => {
                    notification.style.transform = 'translateX(400px)';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }, 3000);
            }
        };

        /**
         * 检查密码匹配
         */
        function checkPasswordMatch() {
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const matchError = document.getElementById('passwordMatchError');

            if (confirmPassword && newPassword !== confirmPassword) {
                matchError.classList.remove('hidden');
                return false;
            } else {
                matchError.classList.add('hidden');
                return true;
            }
        }

        /**
         * 发送验证码
         */
        function sendVerificationCode() {
            const btn = document.getElementById('sendCodeBtn');
            const countdown = document.getElementById('countdown');

            // 模拟发送验证码
            Utils.showNotification('验证码已发送至 138****8888', 'success');

            // 开始倒计时
            btn.disabled = true;
            btn.classList.add('opacity-50', 'cursor-not-allowed');
            countdownSeconds = 60;

            countdownTimer = setInterval(() => {
                if (countdownSeconds > 0) {
                    btn.textContent = `${countdownSeconds}秒后重试`;
                    countdown.textContent = `验证码已发送，${countdownSeconds}秒后可重新发送`;
                    countdown.classList.add('active');
                    countdownSeconds--;
                } else {
                    resetCodeButton();
                    clearInterval(countdownTimer);
                    countdownTimer = null;
                }
            }, 1000);
        }

        /**
         * 重置验证码按钮
         */
        function resetCodeButton() {
            const btn = document.getElementById('sendCodeBtn');
            const countdown = document.getElementById('countdown');

            btn.disabled = false;
            btn.classList.remove('opacity-50', 'cursor-not-allowed');
            btn.textContent = '发送验证码';
            countdown.textContent = '验证码将发送至 138****8888';
            countdown.classList.remove('active');
        }

        /**
         * 处理表单提交
         */
        function handleSubmit(event) {
            event.preventDefault();

            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const verificationCode = document.getElementById('verificationCode').value;

            // 验证密码匹配
            if (newPassword !== confirmPassword) {
                Utils.showNotification('两次输入的密码不一致', 'error');
                return;
            }

            // 验证验证码
            if (!verificationCode || verificationCode.length !== 6) {
                Utils.showNotification('请输入正确的验证码', 'error');
                return;
            }

            // 模拟提交修改密码请求
            const submitBtn = event.target.querySelector('button[type="submit"]');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner loading-spinner mr-2"></i>正在修改...';

            // 模拟网络请求
            setTimeout(() => {
                Utils.showNotification('密码修改成功！请重新登录', 'success');

                // 跳转到登录页面
                setTimeout(() => {
                    window.location.href = 'login.html';
                }, 2000);
            }, 1500);
        }

        /**
         * 导航返回上一页
         */
        function navigateBack() {
            // 如果在iframe中，发送消息给父页面
            if (window.parent !== window) {
                window.parent.postMessage({
                    type: 'navigateBack'
                }, '*');
            } else {
                // 直接返回上一页
                if (window.history.length > 1) {
                    window.history.back();
                } else {
                    // 如果没有历史记录，跳转到安全设置页面
                    window.location.href = 'security_settings.html';
                }
            }
        }

        /**
         * 导航到指定页面
         */
        function navigateToPage(page) {
            // 如果在iframe中，发送消息给父页面
            if (window.parent !== window) {
                window.parent.postMessage({
                    type: 'navigate',
                    page: page
                }, '*');
            } else {
                // 直接跳转
                window.location.href = page + '.html';
            }
        }

        /**
         * 页面初始化
         */
        function initializePage() {
            console.log('修改密码页面初始化完成');
        }

        // 页面加载完成后初始化
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializePage);
        } else {
            initializePage();
        }

        // 页面卸载时清除倒计时
        window.addEventListener('beforeunload', () => {
            if (countdownTimer) {
                clearInterval(countdownTimer);
            }
        });

        console.log('修改密码功能模块加载完成');
    </script>
</body>
</html>